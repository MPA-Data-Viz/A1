---
title: "Assignment 1"
output:
  html_document:
    df_print: paged
---

```{r, include = FALSE}
library(rio)
library(lubridate)
library(tidyverse)

link <- "https://github.com/MPA-Data-Viz/A1/raw/main/Burke.csv"

burke<-import(link)
```

```{r, include = FALSE}
burke$Date<-mdy(burke$Date)

burke <- burke %>% replace(is.na(.), 0)
```

```{r, include=FALSE}
burke_sum<-burke%>%group_by(Date)%>%
  summarise(Total = sum(`BGT North of NE 70th Total`),
            Ped_south = sum(`Ped South`),
            Ped_north = sum(`Ped North`),
            Bike_south = sum(`Bike South`),
            Bike_north = sum(`Bike North`))

burke_sum<-burke_sum%>%mutate(month = month(Date),
                      year = year(Date),
                      ped_total = Ped_south + Ped_north,
                      bike_total = Bike_south + Bike_north)

burke_sum<-burke_sum%>%filter(year <=2017)

burke_sum<-burke_sum%>%mutate(month = case_when(month == 1 ~ "Jan",
                                        month == 2 ~ "Feb",
                                        month == 3 ~ "Mar",
                                        month == 4 ~ "Apr",
                                        month == 5 ~ "May",
                                        month == 6 ~ "Jun",
                                        month == 7 ~ "Jul",
                                        month == 8 ~ "Aug",
                                        month == 9 ~ "Sep",
                                        month == 10 ~ "Oct",
                                        month == 11 ~ "Nov",
                                        month == 12 ~ "Dec"))



burke_table<-burke_sum%>%group_by(month)%>%
  summarise(total = sum(Total, na.rm = TRUE))


burke_table<-burke_table%>%mutate(percent = round(total / sum(total),2))

burke_table$month<-factor(burke_table$month, levels = c('Jan', 'Feb', 'Mar','Apr', 'May', 'Jun',
                                                    'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'))

```

```{r, echo = FALSE, warning=FALSE,message=FALSE}
ggplot(burke_table)+
  geom_bar(aes(month,percent), stat = 'identity')+
  labs(title = "Use of the Burke Gilman Trail Peaks in July",
       subtitle = "Data collected at NE 70th St; 2014-2017",
       x = NULL,
       y = "Percent of Total",
       caption = "Data from data.seattle.gov")+ 
  theme_minimal()
```

